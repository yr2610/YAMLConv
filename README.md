# YAML Exporter（Excel → YAML）使い方ガイド

Excelの表（範囲選択）を YAML に変換してクリップボードへコピーするアドインです。

---

## まずやること（最短手順）

1. Excelで **ヘッダー行（列名）＋データ行** の表を用意します
2. 表全体を範囲選択します
3. リボンの **「YAML出力」** を押します
   （右クリックメニューの **to YAML** からも実行できます）
4. YAMLがクリップボードにコピーされ、プレビュー画面にも表示されます

---

## リボンの設定

### ID生成

* **ON**：各行に `$id` を自動で付けて出力します
* **OFF**：`$id` を出力しません

`$id` をExcel側で作成・編集する運用は想定していません。

---

### TSVコメント

* **ON**：YAMLの先頭に元の表をTSV形式でコメントとして付けます
* **OFF**：YAMLのみ出力します

---

### 表示行のみ

* **ON**：フィルタや非表示になっている行を除外して出力します
* **OFF**：選択範囲のすべての行を対象にします

---

### ID桁

通常は **16 を選んでください（推奨）**。

* **16（推奨）**
  新規データはこちらを使用してください。

* **6（互換用）**
  既存データとの互換性が必要な場合のみ使用します。
  将来的に廃止される可能性があります。

---

## 入力表のルール

* **1行目がヘッダー（列名）**
* **2行目以降がデータ**
* 完全に空の行は自動で無視されます

---

## ヘッダーの書き方

### `*`（ID生成に使う列）

ヘッダーの先頭に `*` を付けた列は、ID生成の材料になります。
複数指定できます。

例：

```
*category
*name
```

**`*` を付けた列がすべて空の行は出力されません。**
（その行は無効扱いになります）

---

### `~`（空欄を自動で埋める）

ヘッダーの先頭に `~` を付けた列は、空欄を直上の値で埋めます。

例：

| ~group | name  |
| ------ | ----- |
| A      | Alice |
|        | Bob   |
| B      | Carol |

この場合、Bob の group は A として扱われます。

---

### `.`（ネスト）

ヘッダーに `.` を使うと、YAMLを階層構造にできます。

例：

```
user.name
user.age
```

↓

```yaml
- user:
    name: Alice
    age: 30
```

---

### `[]`（配列）

ヘッダーの末尾に `[]` を付けると、配列として出力されます。
配列の値は横方向に並べて入力します。

例：

| tags[] |   |   |
| ------ | - | - |
| a      | b | c |

↓

```yaml
- tags: [a, b, c]
```

---

## TSVコメントから表を復元する（Excelに戻す）

TSVコメントをONにすると、出力の先頭に次のような行が付きます。

```
# col1	col2	col3
# A	B	C
# D	E	F
```

### 復元手順

1. TSV部分（`#` で始まる行）だけをメモ帳などに貼り付けます
2. 各行の先頭の `# `（2文字）を削除します
3. そのままExcelに貼り付けます

※ TSV部分だけをコピーしてください（YAML本体は不要です）。

---

## 記法まとめ

| 記法   | 意味            |
| ---- | ------------- |
| `*`  | ID生成に使う列（複数可） |
| `~`  | 空欄を直上の値で埋める   |
| `.`  | 階層構造を作る       |
| `[]` | 配列として出力する     |
